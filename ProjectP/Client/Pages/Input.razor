@page "/"
@using System.Threading
@using System.Threading.Tasks
@using ProjectP.Shared
@using System.Net.Http
@inject HttpClient Http
@inject IJSRuntime JSRuntime

<head>
    <h1>This is ProjectP!</h1>
</head>
<body>
    Write some text.
    <div class="container">
        <div class="row">
            <div class="col-12">
                <textarea class="form-control" id="textarea-to-fit-content" rows="3" value=@GetText @oninput=@ProcText></textarea>
            </div>
        </div>    
    </div>
</body>

@code {
    TextInstance instance = new TextInstance();
    TextInstance fakeInstance = new TextInstance(){Text = "hh"};
    public string GetText { get; set; } = "gg";
    public async Task ProcText(ChangeEventArgs args)
    {
        instance.Text = args.Value.ToString();
        var response = await Http.PostAsJsonAsync("GText", instance);
        fakeInstance = await response.Content.ReadFromJsonAsync<TextInstance>();
        GetText = fakeInstance.Text;

        await JSRuntime.InvokeVoidAsync("fitContent", "Expanding the textarea to fit the content");
    }
}